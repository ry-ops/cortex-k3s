{
  "version": "1.0.0",
  "last_updated": "2025-11-23",
  "description": "Secret detection patterns for security scanning",

  "patterns": [
    {
      "id": "aws-access-key",
      "name": "AWS Access Key ID",
      "pattern": "AKIA[0-9A-Z]{16}",
      "severity": "CRITICAL",
      "category": "cloud_credentials",
      "description": "AWS IAM Access Key ID"
    },
    {
      "id": "aws-secret-key",
      "name": "AWS Secret Access Key",
      "pattern": "(?i)aws(.{0,20})?(?-i)['\"][0-9a-zA-Z/+]{40}['\"]",
      "severity": "CRITICAL",
      "category": "cloud_credentials",
      "description": "AWS IAM Secret Access Key"
    },
    {
      "id": "github-token",
      "name": "GitHub Personal Access Token",
      "pattern": "gh[pousr]_[A-Za-z0-9_]{36,}",
      "severity": "CRITICAL",
      "category": "vcs_tokens",
      "description": "GitHub PAT or OAuth token"
    },
    {
      "id": "github-fine-grained",
      "name": "GitHub Fine-grained Token",
      "pattern": "github_pat_[A-Za-z0-9_]{22}_[A-Za-z0-9]{59}",
      "severity": "CRITICAL",
      "category": "vcs_tokens",
      "description": "GitHub fine-grained personal access token"
    },
    {
      "id": "gitlab-token",
      "name": "GitLab Personal Access Token",
      "pattern": "glpat-[A-Za-z0-9\\-]{20}",
      "severity": "CRITICAL",
      "category": "vcs_tokens",
      "description": "GitLab personal access token"
    },
    {
      "id": "slack-token",
      "name": "Slack Token",
      "pattern": "xox[baprs]-[0-9]{10,13}-[0-9]{10,13}[a-zA-Z0-9-]*",
      "severity": "CRITICAL",
      "category": "messaging",
      "description": "Slack bot or user token"
    },
    {
      "id": "slack-webhook",
      "name": "Slack Webhook URL",
      "pattern": "https://hooks\\.slack\\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[a-zA-Z0-9]+",
      "severity": "HIGH",
      "category": "messaging",
      "description": "Slack incoming webhook URL"
    },
    {
      "id": "stripe-live-key",
      "name": "Stripe Live Secret Key",
      "pattern": "sk_live_[0-9a-zA-Z]{24,}",
      "severity": "CRITICAL",
      "category": "payment",
      "description": "Stripe live mode secret key"
    },
    {
      "id": "stripe-test-key",
      "name": "Stripe Test Secret Key",
      "pattern": "sk_test_[0-9a-zA-Z]{24,}",
      "severity": "MEDIUM",
      "category": "payment",
      "description": "Stripe test mode secret key"
    },
    {
      "id": "sendgrid-key",
      "name": "SendGrid API Key",
      "pattern": "SG\\.[a-zA-Z0-9]{22}\\.[a-zA-Z0-9-_]{43}",
      "severity": "CRITICAL",
      "category": "email",
      "description": "SendGrid API key"
    },
    {
      "id": "twilio-key",
      "name": "Twilio API Key",
      "pattern": "SK[0-9a-fA-F]{32}",
      "severity": "CRITICAL",
      "category": "messaging",
      "description": "Twilio API key"
    },
    {
      "id": "mailgun-key",
      "name": "Mailgun API Key",
      "pattern": "key-[0-9a-zA-Z]{32}",
      "severity": "CRITICAL",
      "category": "email",
      "description": "Mailgun API key"
    },
    {
      "id": "private-key-rsa",
      "name": "RSA Private Key",
      "pattern": "-----BEGIN RSA PRIVATE KEY-----",
      "severity": "CRITICAL",
      "category": "cryptographic",
      "description": "RSA private key in PEM format"
    },
    {
      "id": "private-key-ec",
      "name": "EC Private Key",
      "pattern": "-----BEGIN EC PRIVATE KEY-----",
      "severity": "CRITICAL",
      "category": "cryptographic",
      "description": "Elliptic curve private key"
    },
    {
      "id": "private-key-openssh",
      "name": "OpenSSH Private Key",
      "pattern": "-----BEGIN OPENSSH PRIVATE KEY-----",
      "severity": "CRITICAL",
      "category": "cryptographic",
      "description": "OpenSSH private key"
    },
    {
      "id": "private-key-dsa",
      "name": "DSA Private Key",
      "pattern": "-----BEGIN DSA PRIVATE KEY-----",
      "severity": "CRITICAL",
      "category": "cryptographic",
      "description": "DSA private key"
    },
    {
      "id": "jwt-token",
      "name": "JWT Token",
      "pattern": "eyJ[A-Za-z0-9-_]+\\.eyJ[A-Za-z0-9-_]+\\.[A-Za-z0-9-_.+/=]+",
      "severity": "HIGH",
      "category": "authentication",
      "description": "JSON Web Token"
    },
    {
      "id": "generic-api-key",
      "name": "Generic API Key",
      "pattern": "(?i)(api[_-]?key|apikey|api_secret)\\s*[=:]\\s*['\"][^'\"]{8,}['\"]",
      "severity": "HIGH",
      "category": "generic",
      "description": "Generic API key pattern"
    },
    {
      "id": "generic-secret",
      "name": "Generic Secret",
      "pattern": "(?i)(secret|password|passwd|pwd)\\s*[=:]\\s*['\"][^'\"]{8,}['\"]",
      "severity": "HIGH",
      "category": "generic",
      "description": "Generic secret or password"
    },
    {
      "id": "postgres-url",
      "name": "PostgreSQL Connection URL",
      "pattern": "postgres(ql)?://[^\\s'\"]+:[^\\s'\"]+@[^\\s'\"]+",
      "severity": "CRITICAL",
      "category": "database",
      "description": "PostgreSQL connection string with credentials"
    },
    {
      "id": "mysql-url",
      "name": "MySQL Connection URL",
      "pattern": "mysql://[^\\s'\"]+:[^\\s'\"]+@[^\\s'\"]+",
      "severity": "CRITICAL",
      "category": "database",
      "description": "MySQL connection string with credentials"
    },
    {
      "id": "mongodb-url",
      "name": "MongoDB Connection URL",
      "pattern": "mongodb(\\+srv)?://[^\\s'\"]+:[^\\s'\"]+@[^\\s'\"]+",
      "severity": "CRITICAL",
      "category": "database",
      "description": "MongoDB connection string with credentials"
    },
    {
      "id": "redis-url",
      "name": "Redis Connection URL",
      "pattern": "redis://[^\\s'\"]+:[^\\s'\"]+@[^\\s'\"]+",
      "severity": "CRITICAL",
      "category": "database",
      "description": "Redis connection string with credentials"
    },
    {
      "id": "gcp-service-account",
      "name": "GCP Service Account Key",
      "pattern": "\"type\"\\s*:\\s*\"service_account\"",
      "severity": "CRITICAL",
      "category": "cloud_credentials",
      "description": "Google Cloud service account JSON key"
    },
    {
      "id": "azure-client-secret",
      "name": "Azure Client Secret",
      "pattern": "(?i)(azure|client)[_-]?secret\\s*[=:]\\s*['\"][^'\"]{30,}['\"]",
      "severity": "CRITICAL",
      "category": "cloud_credentials",
      "description": "Azure AD client secret"
    },
    {
      "id": "heroku-api-key",
      "name": "Heroku API Key",
      "pattern": "(?i)heroku[_-]?api[_-]?key\\s*[=:]\\s*['\"][0-9a-f-]{36}['\"]",
      "severity": "HIGH",
      "category": "paas",
      "description": "Heroku API key"
    },
    {
      "id": "npm-token",
      "name": "NPM Access Token",
      "pattern": "//registry\\.npmjs\\.org/:_authToken=[A-Za-z0-9-_]+",
      "severity": "HIGH",
      "category": "package_registry",
      "description": "NPM registry authentication token"
    },
    {
      "id": "pypi-token",
      "name": "PyPI API Token",
      "pattern": "pypi-[A-Za-z0-9_-]{100,}",
      "severity": "HIGH",
      "category": "package_registry",
      "description": "PyPI API token"
    },
    {
      "id": "oauth-client-secret",
      "name": "OAuth Client Secret",
      "pattern": "(?i)client[_-]?secret\\s*[=:]\\s*['\"][^'\"]{20,}['\"]",
      "severity": "HIGH",
      "category": "authentication",
      "description": "OAuth 2.0 client secret"
    },
    {
      "id": "basic-auth-header",
      "name": "Basic Auth Header",
      "pattern": "(?i)authorization\\s*[=:]\\s*['\"]basic\\s+[A-Za-z0-9+/=]+['\"]",
      "severity": "HIGH",
      "category": "authentication",
      "description": "HTTP Basic authentication header"
    }
  ],

  "exclusions": {
    "directories": [
      "node_modules",
      ".git",
      "dist",
      "build",
      "vendor",
      "__pycache__",
      ".venv",
      "venv",
      "target",
      "coverage",
      ".next",
      ".nuxt"
    ],
    "files": [
      "*.min.js",
      "*.min.css",
      "*.map",
      "*.lock",
      "package-lock.json",
      "yarn.lock",
      "*.woff",
      "*.woff2",
      "*.ttf",
      "*.eot",
      "*.png",
      "*.jpg",
      "*.jpeg",
      "*.gif",
      "*.ico",
      "*.pdf",
      "*.zip",
      "*.tar",
      "*.gz"
    ],
    "patterns": [
      "example",
      "sample",
      "test",
      "mock",
      "placeholder",
      "your_api_key_here",
      "xxx",
      "***"
    ]
  },

  "severity_definitions": {
    "CRITICAL": {
      "description": "Active credentials that provide immediate access",
      "action": "Immediate rotation required",
      "escalate": true
    },
    "HIGH": {
      "description": "Credentials or tokens that could be exploited",
      "action": "Rotate within 24 hours",
      "escalate": false
    },
    "MEDIUM": {
      "description": "Test credentials or limited-scope tokens",
      "action": "Review and rotate if production",
      "escalate": false
    },
    "LOW": {
      "description": "Informational or low-risk patterns",
      "action": "Review during regular audit",
      "escalate": false
    }
  }
}
